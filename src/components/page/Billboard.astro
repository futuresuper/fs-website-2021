---
import Clipboard from '../scripts/Clipboard.astro'
---

<style lang="scss">
  @use "../../styles/" as *;
</style>

<div>
  <div>
    <div>
      <h1>
        Your <span id="friend">friend's </span>name is in there somewhere… Can you
        find it?
      </h1>
    </div>

    <img
      class="billboard-image"
      src="https://res.cloudinary.com/future-super/image/upload/c_scale,w_1200,f_auto,q_auto/v1623370119/BillboardTempe.jpg"
      alt="Billboard with the names of recently joined Future Super members"
    />
  </div>

    <div id="share-with-friend">
      <p>Share the billboard with your personal link:</p>
      <div>
        <div id="personal-url">
          www.futuresuper.com.au/billboard?r=
        </div>
        <button onclick="handleCopy()">COPY LINK</button>
      </div>
      <p>
        We’ll let you know when someone joins Future Super from this link so you
        can see the difference you make.
      </p>
    </div>
    <div id="join">
      <div>
        <p>Not a Future Super member yet?</p>
        <button>JOIN NOW</button>
      </div>
    </div>
</div>

<Clipboard /> <!-- enables copyTextToClipboard(text) -->

<script>
  function getQueryVariable(variable) {
    var query = window.location.search.substring(1);
    var vars = query.split("&");
    for (var i = 0; i < vars.length; i++) {
      var pair = vars[i].split("=");
      if (decodeURIComponent(pair[0]) == variable) {
        return decodeURIComponent(pair[1]);
      }
    }
  }
  let code = getQueryVariable("r");
  console.log("REFERER: " + code);
  if (code) {
    document.getElementById("personal-url").innerHTML =
      "www.futuresuper.com.au/billboard?r=" + code;
  }
  let share = getQueryVariable("share") ? true : false;
  console.log("SHARE: " + share);
  if (share) {
    document.getElementById("join").style.display = "none";
    document.getElementById("title-shared").style.display = "none";
  } else {
    document.getElementById("share").style.display = "none";
    document.getElementById("title-sender").style.display = "none";
  }

  function handleCopy() {
    const text = "www.futuresuper.com.au/billboard?r=" + code;
    copyTextToClipboard(text);
    const popup = document.getElementById("popup-message");
    popup.style.display = "flex";
    setTimeout(function () {
      popup.style.display = "none";
    }, 3000);
  }
</script>

